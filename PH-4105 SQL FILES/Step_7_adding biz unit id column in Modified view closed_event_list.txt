 SELECT DISTINCT a_1.id,
    a_1.event_name AS eventname,
    a_1.created_date AS createddate,
    puser.login_id AS createdby,
    a_1.modified_date AS modifieddate,
    a_1.event_type AS type,
    a_1.event_start AS eventstart,
    a_1.event_end AS eventend,
    a_1.referance_number AS referencenumber,
    a_1.business_unit_name AS unitname,
    a_1.event_id AS syseventid,
    puser.user_name AS eventuser,
    a_1.tenantid,
    a_1.openuserid,
    a_1.envelopeuserid,
    a_1.evaluatoruserid,
    a_1.conuserid,
    a_1.openstatus,
    a_1.envelopstatus,
    a_1.enveloptype,
    a_1.enevaluationstatus,
    a_1.evevaluationstatus,
    a_1.isconcluded,
	a_1.bizUnitId as bizUnitId -- new selection for ph-4105
   FROM ( SELECT DISTINCT e.id,
            e.is_billofquantity_req,
            e.budget_amount,
            e.created_date,
            e.buyer_set_decimal,
            e.is_document_req,
            e.event_description,
            e.event_end,
            e.event_id,
            e.event_name,
            e.event_publish_date,
            e.event_start,
            e.event_visibility,
            e.historical_amount,
            e.is_meetings_req,
            e.modified_date,
            e.participation_fees,
            e.payment_term,
            e.is_questionnaires_req,
            e.referance_number,
            e.status,
            e.submission_validity_days,
            e.tenant_id,
            e.currency_id,
            e.cost_center,
            e.created_by,
            e.delivery_address,
            e.event_owner,
            e.event_category,
            e.modified_by,
            e.participation_fee_currency,
            e.template_id,
            e.is_bq_completed,
            e.is_cq_completed,
            e.is_document_completed,
            e.is_envelop_completed,
            e.is_event_detail_completed,
            e.is_meetings_completed,
            e.is_summary_completed,
            e.is_supplier_completed,
            e.action_date,
            e.action_by,
            bu.business_unit_name,
			bu.id as bizUnitId,
            e.suspension_type,
            'Request for Tender'::text AS event_type,
            e.tenant_id AS tenantid,
            eo.user_id AS openuserid,
            en.lead_evaluater AS envelopeuserid,
            ev.user_id AS evaluatoruserid,
            cu.user_id AS conuserid,
            eo.envelop_status AS openstatus,
            en.envelop_status AS envelopstatus,
            en.envelop_type AS enveloptype,
            en.evaluation_status AS enevaluationstatus,
            ev.evaluation_status AS evevaluationstatus,
            cu.is_concluded AS isconcluded
           FROM proc_test_db.proc_rft_events e
             LEFT JOIN proc_test_db.proc_business_unit bu ON e.business_unit_id::text = bu.id::text
             LEFT JOIN proc_test_db.proc_rft_envelop en ON en.event_id::text = e.id::text
             LEFT JOIN proc_test_db.proc_rft_env_open_users eo ON eo.envelope_id::text = en.id::text
             LEFT JOIN proc_test_db.proc_rft_evaluator_user ev ON ev.rft_envelope_id::text = en.id::text
             LEFT JOIN proc_test_db.proc_user evl ON ev.user_id::text = evl.id::text
             LEFT JOIN proc_test_db.proc_rft_eval_con_users cu ON cu.event_id::text = e.id::text
          WHERE e.status::text = 'CLOSED'::text
        UNION
         SELECT DISTINCT e.id,
            e.is_billofquantity_req,
            e.budget_amount,
            e.created_date,
            e.buyer_set_decimal,
            e.is_document_req,
            e.event_description,
            e.event_end,
            e.event_id,
            e.event_name,
            e.event_publish_date,
            e.event_start,
            e.event_visibility,
            e.historical_amount,
            e.is_meetings_req,
            e.modified_date,
            e.participation_fees,
            e.payment_term,
            e.is_questionnaires_req,
            e.referance_number,
            e.status,
            e.submission_validity_days,
            e.tenant_id,
            e.currency_id,
            e.cost_center,
            e.created_by,
            e.delivery_address,
            e.event_owner,
            e.event_category,
            e.modified_by,
            e.participation_fee_currency,
            e.template_id,
            e.is_bq_completed,
            e.is_cq_completed,
            e.is_document_completed,
            e.is_envelop_completed,
            e.is_event_detail_completed,
            e.is_meetings_completed,
            e.is_summary_completed,
            e.is_supplier_completed,
            e.action_date,
            e.action_by,
            bu.business_unit_name,
			bu.id as bizUnitId,
            e.suspension_type,
            'Request for Proposal'::text AS event_type,
            e.tenant_id AS tenantid,
            eo.user_id AS openuserid,
            en.lead_evaluater AS envelopeuserid,
            ev.user_id AS evaluatoruserid,
            cu.user_id AS conuserid,
            eo.envelop_status AS openstatus,
            en.envelop_status AS envelopstatus,
            en.envelop_type AS enveloptype,
            en.evaluation_status AS enevaluationstatus,
            ev.evaluation_status AS evevaluationstatus,
            cu.is_concluded AS isconcluded
           FROM proc_test_db.proc_rfp_events e
             LEFT JOIN proc_test_db.proc_business_unit bu ON e.business_unit_id::text = bu.id::text
             LEFT JOIN proc_test_db.proc_rfp_envelop en ON en.event_id::text = e.id::text
             LEFT JOIN proc_test_db.proc_rfp_env_open_users eo ON eo.envelope_id::text = en.id::text
             LEFT JOIN proc_test_db.proc_rfp_evaluator_user ev ON ev.rfp_envelope_id::text = en.id::text
             LEFT JOIN proc_test_db.proc_user evl ON ev.user_id::text = evl.id::text
             LEFT JOIN proc_test_db.proc_rfp_eval_con_users cu ON cu.event_id::text = e.id::text
          WHERE e.status::text = 'CLOSED'::text
        UNION
         SELECT DISTINCT e.id,
            e.is_billofquantity_req,
            e.budget_amount,
            e.created_date,
            e.buyer_set_decimal,
            e.is_document_req,
            e.event_description,
            e.event_end,
            e.event_id,
            e.event_name,
            e.event_publish_date,
            e.event_start,
            e.event_visibility,
            e.historical_amount,
            e.is_meetings_req,
            e.modified_date,
            e.participation_fees,
            e.payment_term,
            e.is_questionnaires_req,
            e.referance_number,
            e.status,
            e.submission_validity_days,
            e.tenant_id,
            e.currency_id,
            e.cost_center,
            e.created_by,
            e.delivery_address,
            e.event_owner,
            e.event_category,
            e.modified_by,
            e.participation_fee_currency,
            e.template_id,
            e.is_bq_completed,
            e.is_cq_completed,
            e.is_document_completed,
            e.is_envelop_completed,
            e.is_event_detail_completed,
            e.is_meetings_completed,
            e.is_summary_completed,
            e.is_supplier_completed,
            e.action_date,
            e.action_by,
            bu.business_unit_name,
			bu.id as bizUnitId,
            e.suspension_type,
            'Request for Information'::text AS event_type,
            e.tenant_id AS tenantid,
            eo.user_id AS openuserid,
            en.lead_evaluater AS envelopeuserid,
            ev.user_id AS evaluatoruserid,
            cu.user_id AS conuserid,
            eo.envelop_status AS openstatus,
            en.envelop_status AS envelopstatus,
            en.envelop_type AS enveloptype,
            en.evaluation_status AS enevaluationstatus,
            ev.evaluation_status AS evevaluationstatus,
            cu.is_concluded AS isconcluded
           FROM proc_test_db.proc_rfi_events e
             LEFT JOIN proc_test_db.proc_business_unit bu ON e.business_unit_id::text = bu.id::text
             LEFT JOIN proc_test_db.proc_rfi_envelop en ON en.event_id::text = e.id::text
             LEFT JOIN proc_test_db.proc_rfi_env_open_users eo ON eo.envelope_id::text = en.id::text
             LEFT JOIN proc_test_db.proc_rfi_evaluator_user ev ON ev.rfi_envelope_id::text = en.id::text
             LEFT JOIN proc_test_db.proc_user evl ON ev.user_id::text = evl.id::text
             LEFT JOIN proc_test_db.proc_rfi_eval_con_users cu ON cu.event_id::text = e.id::text
          WHERE e.status::text = 'CLOSED'::text
        UNION
         SELECT DISTINCT e.id,
            e.is_billofquantity_req,
            e.budget_amount,
            e.created_date,
            e.buyer_set_decimal,
            e.is_document_req,
            e.event_description,
            e.event_end,
            e.event_id,
            e.event_name,
            e.event_publish_date,
            e.event_start,
            e.event_visibility,
            e.historical_amount,
            e.is_meetings_req,
            e.modified_date,
            e.participation_fees,
            e.payment_term,
            e.is_questionnaires_req,
            e.referance_number,
            e.status,
            e.submission_validity_days,
            e.tenant_id,
            e.currency_id,
            e.cost_center,
            e.created_by,
            e.delivery_address,
            e.event_owner,
            e.event_category,
            e.modified_by,
            e.participation_fee_currency,
            e.template_id,
            e.is_bq_completed,
            e.is_cq_completed,
            e.is_document_completed,
            e.is_envelop_completed,
            e.is_event_detail_completed,
            e.is_meetings_completed,
            e.is_summary_completed,
            e.is_supplier_completed,
            e.action_date,
            e.action_by,
            bu.business_unit_name,
			bu.id as bizUnitId,
            e.suspension_type,
            'Request for Quotation'::text AS event_type,
            e.tenant_id AS tenantid,
            eo.user_id AS openuserid,
            en.lead_evaluater AS envelopeuserid,
            ev.user_id AS evaluatoruserid,
            cu.user_id AS conuserid,
            eo.envelop_status AS openstatus,
            en.envelop_status AS envelopstatus,
            en.envelop_type AS enveloptype,
            en.evaluation_status AS enevaluationstatus,
            ev.evaluation_status AS evevaluationstatus,
            cu.is_concluded AS isconcluded
           FROM proc_test_db.proc_rfq_events e
             LEFT JOIN proc_test_db.proc_business_unit bu ON e.business_unit_id::text = bu.id::text
             LEFT JOIN proc_test_db.proc_rfq_envelop en ON en.event_id::text = e.id::text
             LEFT JOIN proc_test_db.proc_rfq_env_open_users eo ON eo.envelope_id::text = en.id::text
             LEFT JOIN proc_test_db.proc_rfq_evaluator_user ev ON ev.rfq_envelope_id::text = en.id::text
             LEFT JOIN proc_test_db.proc_user evl ON ev.user_id::text = evl.id::text
             LEFT JOIN proc_test_db.proc_rfq_eval_con_users cu ON cu.event_id::text = e.id::text
          WHERE e.status::text = 'CLOSED'::text
        UNION
         SELECT DISTINCT e.id,
            e.is_billofquantity_req,
            e.budget_amount,
            e.created_date,
            e.buyer_set_decimal,
            e.is_document_req,
            e.event_description,
            e.event_end,
            e.event_id,
            e.event_name,
            e.event_publish_date,
            e.event_start,
            e.event_visibility,
            e.historical_amount,
            e.is_meetings_req,
            e.modified_date,
            e.participation_fees,
            e.payment_term,
            e.is_questionnaires_req,
            e.referance_number,
            e.status,
            e.submission_validity_days,
            e.tenant_id,
            e.currency_id,
            e.cost_center,
            e.created_by,
            e.delivery_address,
            e.event_owner,
            e.event_category,
            e.modified_by,
            e.participation_fee_currency,
            e.template_id,
            e.is_bq_completed,
            e.is_cq_completed,
            e.is_document_completed,
            e.is_envelop_completed,
            e.is_event_detail_completed,
            e.is_meetings_completed,
            e.is_summary_completed,
            e.is_supplier_completed,
            e.action_date,
            e.action_by,
            bu.business_unit_name,
			bu.id as bizUnitId,
            e.suspension_type,
            'Request for Auction'::text AS event_type,
            e.tenant_id AS tenantid,
            eo.user_id AS openuserid,
            en.lead_evaluater AS envelopeuserid,
            ev.user_id AS evaluatoruserid,
            cu.user_id AS conuserid,
            eo.envelop_status AS openstatus,
            en.envelop_status AS envelopstatus,
            en.envelop_type AS enveloptype,
            en.evaluation_status AS enevaluationstatus,
            ev.evaluation_status AS evevaluationstatus,
            cu.is_concluded AS isconcluded
           FROM proc_test_db.proc_rfa_events e
             LEFT JOIN proc_test_db.proc_business_unit bu ON e.business_unit_id::text = bu.id::text
             LEFT JOIN proc_test_db.proc_rfa_envelop en ON en.event_id::text = e.id::text
             LEFT JOIN proc_test_db.proc_rfa_env_open_users eo ON eo.envelope_id::text = en.id::text
             LEFT JOIN proc_test_db.proc_rfa_evaluator_user ev ON ev.rfa_envelope_id::text = en.id::text
             LEFT JOIN proc_test_db.proc_user evl ON ev.user_id::text = evl.id::text
             LEFT JOIN proc_test_db.proc_rfa_eval_con_users cu ON cu.event_id::text = e.id::text
          WHERE e.status::text = 'CLOSED'::text) a_1,
    proc_test_db.proc_user puser
  WHERE a_1.created_by::text = puser.id::text
  ORDER BY a_1.event_end DESC;